<?php


/* ????? ?????????? ? ????? ?????? (??????) */
class Database
{
    /* ??????????? ? ??*/
    protected function sql_connect()
    {
        mysql_connect('localhost', 'root', '');
        mysql_select_db('test');
    }

    /* ?????????? ?? ?? ??????????????? ??????? ?????? ??????  */
    protected function sql_query($sql)
    {
        $res = mysql_query($sql);
        $ret = [];
        while (false !== $row = mysql_fetch_assoc($res))
        {
            $ret[] = $row;
        }
        return $ret;
    }

    /* ??????????  ???????  ? ?? */
    protected function sql_exec($sql)
    {
        mysql_query($sql);
    }


    /* ??????????? ? ???? ??????  ? ???????????? ?????? */
    public function __construct () {
        $this->sql_connect();
    }

    /* ????????? ??????????????  ?? ???? ? ???????? ??????? ??????? ???????? ?? ?? */
    public function news_get_all()
    {
        $sql = 'SELECT * FROM news ORDER BY data DESC';
        return $this->sql_query($sql);
    }

    /* ????????? ??????? ? ?????????? ???????? ?? ?? ?? ? ID */
    public function news_get_current($id)
    {
        $sql = 'SELECT  *  FROM news WHERE id='. $id;
        $res = $this->sql_query($sql);
        $res = $res[0];
        return $res;
    }

    /* ?????????? ????? ??????? ? ?? */
    public function news_insert($data)
    {
        $sql = "INSERT INTO news (title, text, data) VALUES ('" . $data['title'] . "', '" . $data['text'] . "', '" . $data['data'] . "')";
        $this->sql_exec($sql);
    }

    /*  ?????????????? ????????? ??????? (????? ??????? ?????????????? ?? id  */
    public  function  news_edit($data)
    {
        $sql = "UPDATE news SET title='" . $data['title'] . "', text='" . $data['text'] . "', data='" . $data['data'] . "' WHERE id=". $data['id'];
        $this->sql_exec($sql);
    }
}
